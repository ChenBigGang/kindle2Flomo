(function(e){function t(t){for(var n,l,i=t[0],r=t[1],s=t[2],u=0,b=[];u<i.length;u++)l=i[u],Object.prototype.hasOwnProperty.call(c,l)&&c[l]&&b.push(c[l][0]),c[l]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);d&&d(t);while(b.length)b.shift()();return a.push.apply(a,s||[]),o()}function o(){for(var e,t=0;t<a.length;t++){for(var o=a[t],n=!0,i=1;i<o.length;i++){var r=o[i];0!==c[r]&&(n=!1)}n&&(a.splice(t--,1),e=l(l.s=o[0]))}return e}var n={},c={app:0},a=[];function l(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,l),o.l=!0,o.exports}l.m=e,l.c=n,l.d=function(e,t,o){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(l.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)l.d(o,n,function(t){return e[t]}.bind(null,n));return o},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/Send2flomo/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],r=i.push.bind(i);i.push=t,i=i.slice();for(var s=0;s<i.length;s++)t(i[s]);var d=r;a.push([1,"chunk-vendors"]),o()})({0:function(e,t){},"0645":function(e,t,o){"use strict";o("d0b2")},"0e49":function(e,t){function o(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}o.keys=function(){return[]},o.resolve=o,e.exports=o,o.id="0e49"},1:function(e,t,o){e.exports=o("cd49")},10:function(e,t){},11:function(e,t){},12:function(e,t){},"16b5":function(e,t,o){"use strict";o("6cf5")},2:function(e,t){},"254e":function(e,t,o){"use strict";o("65b1")},3:function(e,t){},"3ac7":function(e,t){function o(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}o.keys=function(){return[]},o.resolve=o,e.exports=o,o.id="3ac7"},"3b98":function(e,t,o){var n={"./build":"3f69","./build.js":"3f69","./clean":"ad2a","./clean.js":"ad2a","./configure":"cb9a","./configure.js":"cb9a","./info":"0870","./info.js":"0870","./install":"50f0","./install.js":"50f0","./main":"9f6e","./main.js":"9f6e","./node-pre-gyp":"0d64","./node-pre-gyp.js":"0d64","./package":"57d1","./package.js":"57d1","./pre-binding":"51ae","./pre-binding.js":"51ae","./publish":"800b","./publish.js":"800b","./rebuild":"6780","./rebuild.js":"6780","./reinstall":"1d1d","./reinstall.js":"1d1d","./reveal":"fde4","./reveal.js":"fde4","./testbinary":"6089","./testbinary.js":"6089","./testpackage":"6b83","./testpackage.js":"6b83","./unpublish":"79c3","./unpublish.js":"79c3","./util/abi_crosswalk":"ac51","./util/abi_crosswalk.json":"ac51","./util/compile":"925d","./util/compile.js":"925d","./util/handle_gyp_opts":"4395","./util/handle_gyp_opts.js":"4395","./util/napi":"6d32","./util/napi.js":"6d32","./util/nw-pre-gyp/index.html":"c1ec","./util/nw-pre-gyp/package":"09e5","./util/nw-pre-gyp/package.json":"09e5","./util/s3_setup":"fee3","./util/s3_setup.js":"fee3","./util/versioning":"1b0e","./util/versioning.js":"1b0e"};function c(e){var t=a(e);return o(t)}function a(e){if(!o.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}c.keys=function(){return Object.keys(n)},c.resolve=a,e.exports=c,c.id="3b98"},4:function(e,t){},5:function(e,t){},5893:function(e,t,o){var n={"./en-US.ts":"f197","./zh-CN.ts":"a8b7"};function c(e){var t=a(e);return o(t)}function a(e){if(!o.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}c.keys=function(){return Object.keys(n)},c.resolve=a,e.exports=c,c.id="5893"},6:function(e,t){},"643c":function(e,t,o){},"65b1":function(e,t,o){},"6cf5":function(e,t,o){},7:function(e,t){},8:function(e,t){},9:function(e,t){},9536:function(e,t,o){},a596:function(e,t,o){e.exports=o.p+"img/qrcode.3f46061c.png"},a8b7:function(e,t,o){"use strict";o.r(t),t["default"]={parse:"解析","how-export":"如何导出 HTML？","questions-and-answers":"常见问题解答",weread:"微信读书","parse-options":"解析设置","hide-tag":"隐藏 Tag","position-of-tag":"位置",top:"顶部",bottom:"底部",on:"启用",off:"禁用","book-name":"书名","book-list":"书籍列表",import:"导入","api-options":"Api 设置","tag-options":"Tag 设置","notes-options":"笔记设置","reading-notes":"正在读取","upload-file":"上传 HTML/TXT/JSON 文件",thanks:"感谢 lupeng",all:"全选","not-all":"全不选","check-update":"检查更新",blog:"博客",jike:"即刻",help:"帮助",save:"保 存",cancel:"取 消"}},aed2:function(e,t,o){},c19a:function(e,t,o){"use strict";o("aed2")},c51b:function(e,t,o){},c782:function(e,t){function o(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}o.keys=function(){return[]},o.resolve=o,e.exports=o,o.id="c782"},c7b3:function(e,t,o){const n=o("1b08").verbose(),c=o("cad9"),a=function(e,t){return new n.Database(c.join(e,t))};e.exports={db:a}},c8a0:function(e,t,o){"use strict";o("643c")},cd49:function(e,t,o){"use strict";o.r(t);var n=o("9fbb"),c=o("5031");const a={class:"the-head"};var l=Object(n["defineComponent"])({__name:"index",setup(e){const{t:t,locale:o}=Object(c["b"])();Object(n["ref"])(!1);return(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",a))}}),i=(o("254e"),o("fc3e")),r=o.n(i);const s=r()(l,[["__scopeId","data-v-449b818b"]]);var d=s,u=(o("cdf1"),o("df65")),b=o.n(u),p=o("80e0");function f(){const e=new p["a"]("booknotes");return e.version(1).stores({notes:"++id, uuid, title",books:"++id, uuid, title"}),e}const O=f();async function m(e,t="notes"){const o=await O[t].where("uuid").equals(e).toArray();return o?o[0]:null}async function j(e="notes"){return await O[e].reverse().toArray()}async function h(e,t="notes"){return await O[t].where("title").equals(e).toArray()}async function g(e,t="notes"){return e instanceof Array?await O[t].bulkAdd(e):await O[t].add(e)}async function v(e,t="notes"){return await O[t].put(e)}var k=o("39c5");function N(e,t,o){const{noTag:n,tagPosition:c,noEmptyLine:a}=e;let l=o;return n||(c?l=(a?t+"\r\n":t+"\r\n\r\n")+l:l+=a?t:"\r\n"+t),l}function w(e,t,o){const{split:n,tagPosition:c,notePosition:a,noEmptyLine:l,noTag:i}=e,r=JSON.parse(JSON.stringify(t)).map(t=>{const c=t.text+"\r\n",i=t.note?`${n}${n||l?"\r\n":""}`:"";let r=t.note?[c,i,t.note+"\r\n"]:[c,i];a&&r.reverse();let s=r.filter(e=>e).join(l?"":"\r\n");const d=N(e,o,s);return t.content=t.content_update||d,t.content_temp=t.content_update||d,t});return r}function x(){const e=new Date,t=e.getFullYear(),o=e.getMonth()+1,n=e.getDate();return`${t}${o}${n}`}const V=x(),y=Object(k["a"])({state(){return{importCount:0,textList:[],tempList:[],bookList:[],parseOptions:null}},mutations:{UPDATE_BOOK(e,t){const o=e.bookList.find(e=>e.title===t.title);o.book=t.book},SORT_BOOK_LIST(e,t){if(t instanceof Array)for(let o=0;o<t.length;o++){const n=t[o],c=e.bookList.findIndex(e=>e.title===n);e.bookList.unshift(e.bookList.splice(c,1)[0])}else{const o=e.bookList.findIndex(e=>e.title===t);e.bookList.unshift(e.bookList.splice(o,1)[0])}},SET_BOOK_LIST(e,t){e.bookList=t;const o=t.map(e=>e.title);localStorage.setItem("bookSort",JSON.stringify(o))},UPDATE_PARSE_OPTIONS(e,t){e.parseOptions=t},UPDATE_TEXT_LIST(e,t){const{parseOptions:o,bookList:n}=e;if(!n.length||!o)return[];const{options:c}=o,a=n.find(e=>e.title===c.title);if(a&&a.texts){const e=a.texts.findIndex(e=>e.uuid===t.uuid);e>=0&&(a.texts[e]={...a.texts[e],...t})}},SET_IMPORT_COUNT(e,t){e.importCount=t,localStorage.setItem("importCount",JSON.stringify({[V]:t}))},SELECT_ALL({parseOptions:e,bookList:t},o){const n=t.find(t=>t.title===e.options.title);n.texts.forEach(e=>{e.checked=o})},GET_IMPORT_COUNT(e){let t=JSON.parse(localStorage.getItem("importCount")||"{}");e.importCount=+t[V]||0}},getters:{textList:e=>{const{parseOptions:t,bookList:o=[]}=e;if(!o.length||!t)return[];const{options:n,tag:c}=t,a=o.find(e=>e.title===n.title);return a?w(n,a.texts,c):[]},bookList:e=>e.bookList,selectedList:(e,t)=>t.textList.filter(e=>e.checked),importDisabled:(e,t)=>t.selectedList.length>=100,importCount:e=>e.importCount,isElectron:()=>!!Object({NODE_ENV:"production",BASE_URL:"/Send2flomo/"}).IS_ELECTRON,parseOptions:e=>e.parseOptions}});var E=y;const T=E.getters.isElectron;let _={},C={};function S(e){if(!e)return!1;T&&C.openExternal(e)}function L(e){return e.map(e=>({...e,checked:!1,content:"",content_temp:""}))}function A(e){const t={...Object(n["toRaw"])(e)};return delete t.checked,delete t.content,delete t.content_temp,t}async function D(e=[],t=!0){const o=await j("books"),n=[];for(let c=0;c<o.length;c++){const e=o[c],t=await h(e.title);n.push({...e,texts:L(t)})}if(t&&e.length)for(let c=0;c<e.length;c++){const t=e[c],o=n.findIndex(e=>e.title===t);n.unshift(n.splice(o,1)[0])}return E.commit("SET_BOOK_LIST",n),n}T&&(C=o("4312").shell,_=o("caea").ipcRenderer);var B=D;function I(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function U(e){if(!I(e))return e;for(var t,o,n=1,c=arguments.length;n<c;n++)for(o in t=arguments[n],t)e[o]=t[o];return e}function P(e){return-1!==e.indexOf("标注")||-1!==e.indexOf("Highlight")?1:(-1!==e.indexOf("笔记")||-1!==e.indexOf("备注")||-1!==e.indexOf("书签")||e.indexOf("Bookmark"),2)}var R={split_created:function(e){e=e.split("|").map(e=>e.trim());try{var t=e[0].substr(2),o=t.replace(/[^0-9]/gi,""),n=P(t);return{type:n,position:1===n?t:o,note:""}}catch(c){return{note:"",position:"",date:""}}},split_book:function(e){e=e.replace(/（/g,"(").replace(/）/g,")");try{var t=/(.+)\((.+)\)/,o=t.exec(e);return o?{book:o[1].trim(),author:o[2].trim()}:{book:e,author:""}}catch(n){console.log(n)}}};function M(e){this.position="",this.book="",this.author="",this.date=null,this.content="",this.texts=e,this.type="",this.init()}async function q(e){e=e.split("==========").filter(e=>e);const t=[],o=[];e.map(F).forEach(e=>{e&&(1===e.type&&e.content&&o.push(e),2===e.type&&e.content&&t.push(e))}),t.forEach(e=>{const t=o.findIndex(t=>-1!==t.position.indexOf(e.position));-1!==t&&(o[t].note=e.content)});const n=[];for(let c=0;c<o.length;c++){const e=o[c],t=e.book,a=b()(`${e.book}${e.content}`),l=e.content,i=e.note;if(!n.includes(t)){n.push(t);const e=b()(t),o={uuid:e,title:t,book:t,from:"kindle"},c=await m(e,"books");c||await g(o,"books")}let r={uuid:a,title:t,text:l,note:i,content_update:"",uploaded:!1,from:"kindle"};const s=await m(a);s||await g(r)}return await B(n),!0}function F(e){return e=e.trim(),e?new M(e):null}M.prototype.init=function(){var e=this.texts.replace(/^(\n|\r)*/g,"").replace(/(\n|\r)*$/g,"").split("\r\n").filter(e=>e&&"\n"!==e&&"\r"!==e),t=null;t=R.split_book(e[0]),U(this,t),e[1]&&(t=R.split_created(e[1]),U(this,t)),this.content=e[2],t=null};var $=q;const z=o("052d");async function J(e){let t=e.replace(/\n|\r/g,""),o=z.load(t);o("h3.noteHeading").length&&(t=t.replace(/<\/h3>/g,"</div>").replace(/<\/div><div class='noteText'>/g,"</h3><div class='noteText'>"),o=z.load(t));let n=o(".bookTitle")[0];const c=o(n).text().trim(),a=Array.from(o(".noteText")),l=a.length-1,i=[];for(let u=l;u>=0;u--){const e=a[u],t=P(e.prev.children[0].data),o=e.children.filter(e=>"text"===e.type).map(e=>e.data.trim()).join("");if(2===t&&i.push(o),1===t){const e=b()(`${c}${o}`),t=i.pop()||"",n={uuid:e,title:c,text:o,note:t,content_update:"",uploaded:!1,from:"kindle"},a=await m(e);a||await g(n)}}const r=b()(c),s={uuid:r,title:c,book:c,from:"kindle"},d=await m(r,"books");return d||await g(s,"books"),await B([c]),!0}var H=J;async function K(e){try{const{entries:t,title:o}=e,n=b()(o);let c={uuid:n,title:o,book:o,from:"koreader"};const a=await m(n,"books");if(a||await g(c,"books"),t&&t.length)for(let e=0;e<t.length;e++){const{text:n}=t[e],c=b()(`${o}${n}`);let a={uuid:c,title:o,text:n,note:"",content_update:"",uploaded:!1,from:"koreader"};const l=await m(c);l||await g(a)}return await B([o]),!0}catch(t){return Promise.reject(t)}}async function Z(e){const t=JSON.parse(e);if(console.log(t),t.documents&&Array.isArray(t.documents))for(let o=0;o<t.documents.length;o++)await K(t.documents[o]);t.entries&&t.entries.length&&await K(t)}let X={},W={},G={},Y=function(){},Q=function(){return Promise.resolve(!0)};Object({NODE_ENV:"production",BASE_URL:"/Send2flomo/"}).IS_ELECTRON&&(X=o("80b9"),W=o("da59"),G=o("ae8f"),Y=o("c7b3").db,Q=function(){const e=W.homedir(),t="/Library/Containers/com.apple.iBooksX/Data/Documents/AEAnnotation/";let o="";try{o=X.readdirSync(`${e}${t}`)}catch(a){return Promise.reject("未发现笔记文件")}const n=o.find(e=>"sqlite"===e.slice(-6).toLowerCase());if(!n)return Promise.reject("未发现笔记文件");const c=Y(`${e}${t}`,n);return new Promise((t,o)=>{c.all("\n          SELECT\n              ZANNOTATIONREPRESENTATIVETEXT as BroaderText,\n              ZANNOTATIONSELECTEDTEXT as SelectedText,\n              ZANNOTATIONNOTE as Note,\n              ZFUTUREPROOFING5 as Chapter,\n              ZANNOTATIONCREATIONDATE as Created,\n              ZANNOTATIONMODIFICATIONDATE as Modified,\n              ZANNOTATIONLOCATION as Localtion,\n              ZANNOTATIONASSETID\n          FROM ZAEANNOTATION\n          WHERE ZANNOTATIONSELECTEDTEXT IS NOT NULL\n          AND ZANNOTATIONDELETED = 0\n          ORDER BY ZANNOTATIONASSETID ASC\n        ",(async function(n,c){if(n)o("笔记解析出错");else{const n=e+"/Library/Containers/com.apple.BKAgentService/Data/Documents/iBooks/Books/Books.plist";let l={},i=[];try{const e=await G.parseFile(n);if(l=e[0],l&&l.Books&&l.Books.length){i=l.Books;for(let e=0;e<l.Books.length;e++){const{itemName:t}=l.Books[e],o=t,n=b()(o);let c={uuid:n,title:o,book:o,from:"applebooks"};const a=await m(n,"books");a||await g(c,"books")}}}catch(a){console.log(a),o("图书列表解析出错")}if(c.length)try{for(let e=0;e<c.length;e++){const t=c[e],o=i.findIndex(e=>e.BKGeneratedItemId===t.ZANNOTATIONASSETID);if(o>-1){const e=i[o].itemName,n=t.SelectedText,c=t.Note||"",a=t.Localtion||"",l=t.ZANNOTATIONASSETID||"",r=b()(`${e}${n}`);let s={uuid:r,title:e,text:n,note:c,localtion:a,assetid:l,content_update:"",uploaded:!1,from:"applebooks"};const d=await m(r);d||await g(s)}}}catch(a){console.log(a)}await B(i.map(e=>e.itemName)),t(!0)}}))})});var ee=Q;o("d5cc");const te=/◆ (\d{4}\/\d{2}\/\d{2})发表想法\n{2}([\S\n]*)\n{2}原文：([\S ]*)/g,oe=/◆ (?!\d{4}\/\d{2}\/\d{2})([\S ]*)/g,ne=/《(\S*)》\s{2}(\S*)\s{1}(\d*)个笔记/g;async function ce(e){try{const t=[...e.matchAll(ne)];if(t.length>1||0===t.length)return!1;const o=t[0][1],n=(t[0][2],b()(o));let c={uuid:n,book:o,title:o,from:"weread"};const a=await m(n,"books");return a||await g(c,"books"),c}catch(t){return Promise.reject(t)}}async function ae(e,t){const o=e.title,n=[...t.matchAll(te)].map(e=>({note:e[2],text:e[3]})),c=[...t.matchAll(oe)].map(e=>({text:e[1]}));n.push(...c);for(let a=0;a<n.length;a++){const e=n[a],t=b()(`${o}${e.text}${e.note?e.note:""}`);let c={uuid:t,title:o,text:e.text,note:e.note,content_update:"",uploaded:!1,from:"weread"};const l=await m(t);l||await g(c)}}async function le(e){const t=await ce(e);return await ae(t,e),await B([t.title]),!0}var ie=o("5fff"),re=o("bcf9"),se=o("4ade"),de=o.n(se);function ue(){return new Promise((e,t)=>{try{const{session:n}=o("4312");n.defaultSession.cookies.get({url:"https://weread.qq.com"}).then(o=>{if(o&&o.length){const n=o.find(e=>"wr_vid"===e.name);n&&e(n.value),t(!1)}t(!1)}).catch(()=>t(!1))}catch(n){console.log(n),t(!1)}})}de.a.defaults.baseURL="https://i.weread.qq.com";const be={Host:"i.weread.qq.com",Connection:"keep-alive","Upgrade-Insecure-Requests":1,"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3","Accept-Encoding":"gzip, deflate, br","Accept-Language":"zh-CN,zh;q=0.9,en;q=0.8"};de.a.interceptors.request.use((function(e){return{...e}}),(function(e){return Promise.reject(e)})),de.a.interceptors.response.use((function(e){return e.data}),(function(e){const{response:t}=e;if(t)return console.log(t.statusText,t.data&&t.data.errmsg),Promise.reject(t.data);console.log("something wrong")}));const pe=e=>de()({method:"get",url:"/book/bookmarklist",headers:be,params:{bookId:e}}),fe=async()=>{const e=await ue().catch(e=>{console.log(e)});return e?de()({method:"get",headers:be,url:"/user/notebooks"}):Promise.reject(401)},Oe=async e=>{const t=await ue().catch(e=>{});return de()({method:"get",url:"/web/review/list",baseURL:"https://weread.qq.com",headers:be,params:{userVid:t,...e}})};function me(){const{session:e}=o("4312");return new Promise((t,o)=>{e.defaultSession.cookies.get({url:"https://weread.qq.com/"}).then(n=>{try{for(var c=0;c<n.length;c++)e.defaultSession.cookies.remove("https://weread.qq.com/",n[c].name,e=>{console.log("cookie 清除出错")});t()}catch(a){o()}}).catch(()=>o())})}async function je(){try{const e=await fe(),t=e.books;if(t&&t.length){for(let e=0;e<t.length;e++){const o=t[e],n=o.book.title,c=o.bookId,a=b()(n),l={uuid:a,title:n,form:"weread",book:n,bookId:c},i=await m(a,"books");i||await g(l,"books")}return t.map(e=>e.book)}return Promise.reject([])}catch(e){return 401===e&&me(),Promise.reject(e)}}async function he(e,t){try{const o=await pe(e);if(-2012===o.errcode)return Promise.reject(401);const n=o.updated;for(let e=0;e<n.length;e++){const o=n[e],c=b()(`${t}${o.markText}`),a=o.markText,l="";let i={uuid:c,title:t,text:a,note:l,content_update:"",uploaded:!1,form:"weread"};const r=await m(c);r||await g(i)}return!0}catch(o){return Promise.reject(o)}}async function ge({title:e,...t}){try{const o=await Oe(t);if(-2012===o.errcode)return Promise.reject(401);const n=o.reviews;for(let t=0;t<n.length;t++){const o=n[t],c=o.review.abstract,a=b()(`${e}${c}`),l=o.review.content||"";let i={uuid:a,title:e,text:c,note:l,content_update:"",uploaded:!1,form:"weread"};const r=await m(a);r||await g(i)}return!0}catch(o){return Promise.reject(o)}}const ve=e=>(Object(n["pushScopeId"])("data-v-67e19656"),e=e(),Object(n["popScopeId"])(),e),ke={class:"left-bar-form"},Ne={class:"left-bar-form-content"},we={class:"left-bar-form-content-top"},xe={class:"upload-content radius flex pd-10 border"},Ve=ve(()=>Object(n["createElementVNode"])("i",{class:"el-icon-folder-add"},null,-1)),ye={class:"el-upload__text"},Ee={class:"how"},Te=ve(()=>Object(n["createElementVNode"])("i",{class:"el-icon-question"},null,-1)),_e=ve(()=>Object(n["createElementVNode"])("div",{class:"pb-10"},[Object(n["createElementVNode"])("span",{class:"bold text-highlight"},"JSON:"),Object(n["createTextVNode"])(" KOReader 导出的 JSON 文件 ")],-1)),Ce=ve(()=>Object(n["createElementVNode"])("div",{class:"pb-10"},[Object(n["createElementVNode"])("span",{class:"bold text-highlight"},"HTML:"),Object(n["createTextVNode"])(" Kindle 或 Kindle App 导出的 HTML 文件 ")],-1)),Se=ve(()=>Object(n["createElementVNode"])("div",{class:"pb-16"},[Object(n["createElementVNode"])("span",{class:"bold text-highlight"},"TXT:"),Object(n["createTextVNode"])(" Kindle 的 My Clippings.txt 文件 ")],-1)),Le=ve(()=>Object(n["createElementVNode"])("div",{class:"pb-6 bold text-highlight"}," My Clippings.txt 在哪？ ",-1)),Ae=ve(()=>Object(n["createElementVNode"])("div",{class:"pb-16"},[Object(n["createElementVNode"])("div",{class:"pb-4"}," 将 Kindle 通过数据线连接至电脑 "),Object(n["createTextVNode"])(" 文件位于：Kindle根目录 - document - My Clippings.txt ")],-1)),De={class:"pointer"},Be={class:"how"},Ie=ve(()=>Object(n["createElementVNode"])("i",{class:"el-icon-question"},null,-1)),Ue=ve(()=>Object(n["createElementVNode"])("div",null,[Object(n["createElementVNode"])("div",{class:"pb-10"}," 微信读书中复制笔记到粘贴板，粘贴到上面的输入框 ")],-1)),Pe={class:"pointer"},Re={class:"flex thired-import"},Me={class:"pointer text-center border pd-10 radius"},qe=ve(()=>Object(n["createElementVNode"])("div",{slot:"content",style:{"line-height":"1.5em"}},[Object(n["createElementVNode"])("b",null,"点击下载应用"),Object(n["createElementVNode"])("br"),Object(n["createTextVNode"])(" 由于 Apple Books 与微信读书笔记的读取方式限制， "),Object(n["createElementVNode"])("br"),Object(n["createTextVNode"])(" 必须安装客户端才能使用。 ")],-1)),Fe=ve(()=>Object(n["createElementVNode"])("a",{class:"link",href:"https://github.com/Tit1e/kindle2Flomo/releases",target:"_blank"}," 从 Apple Books / 微信读书 导入 ",-1)),$e=ve(()=>Object(n["createElementVNode"])("a",{class:"how link",href:"https://evolly.one/2021/05/30/158-mac-handle-bad-app/",target:"_blank"}," Send2flomo.app 打不开？ ",-1)),ze={class:"left-bar-form-content-body"},Je=ve(()=>Object(n["createElementVNode"])("i",{class:"el-icon-set-up mr-4"},null,-1)),He={class:"flex"},Ke={class:"flex-1"},Ze={class:"flex-1 pl-10"},Xe=ve(()=>Object(n["createElementVNode"])("span",{class:"fz-12"},[Object(n["createElementVNode"])("b",{class:"highlight"},"仅在有笔记时生效"),Object(n["createTextVNode"])("，且总在笔记与摘录之间")],-1)),We=ve(()=>Object(n["createElementVNode"])("i",{class:"el-icon-notebook-2 mr-4"},null,-1)),Ge={class:"list-wrap"},Ye={class:"left-bar-bottom"},Qe={class:"iframe-box"},et={key:0,src:"https://weread.qq.com/#login",frameborder:"0"},tt={class:"text-center"};var ot=Object(n["defineComponent"])({__name:"index",emits:["update-tag","parse","submit","list-update"],setup(e,{emit:t}){const{t:o}=Object(c["b"])(),a=t,l=Object(n["ref"])(""),i=Object(k["b"])(),r=Object(n["computed"])(()=>i.getters.selectedList),s=Object(n["computed"])(()=>i.getters.importCount>=100),d=Object(n["computed"])(()=>i.getters.bookList);function u(e){let t=d.value.find(e=>e.title===p.title);t&&(t={...t,book:e.target.value},delete t.texts),i.commit("UPDATE_BOOK",t),v(t,"books")}Object(n["watch"])(()=>d.value[0],(e,t={})=>{e&&e.title!==t.title&&g(e)});const b=i.getters.isElectron;let p=Object(n["reactive"])({book:"",title:"",split:"",tag:"kindle",api:"",noTag:!1,tagPosition:!1,notePosition:!1,noEmptyLine:!0}),f=Object(n["ref"])("1");Object(n["watch"])(()=>f.value,e=>{window.localStorage.setItem("activeName",e)});const O=Object(n["computed"])(()=>!r.value.length||!p.api||s.value);function m(){const e=JSON.parse(localStorage.getItem("options")||"{}");p=Object(n["reactive"])({...p,...e}),f.value=window.localStorage.getItem("activeName")||"1"}async function j(e,t=!0,o){const n=e.reverse(),{bookId:c,title:a}=n[0],l=ge({title:a,bookId:c,listType:11,maxIdx:0,count:0,listMode:2,synckey:0,mine:1}),i=he(c,a);try{await Promise.all([l,i]),t?await B(n.map(e=>e.title),t):await B(d.value.map(e=>e.title).reverse(),!0),o.close()}catch(r){console.log(r),-2012===r.errcode&&V(),o.close()}}function h(e){const t=d.value.find(t=>t.title===e);if(!t)return!1;if(t.bookId){const e=y();j([t],!1,e)}g(t)}function g(e){const{title:t,texts:o,bookId:n,book:c}=e;p.title=t,p.book=c,A(),a("list-update",{list:o,options:p}),T(!0)}m(),Object(n["watch"])(()=>p,()=>{A(),T()},{deep:!0});const N=Object(n["ref"])(!1),w=Object(n["ref"])(!1);function x(e){je().then(t=>{N.value=!1,w.value=!1,j(t,!0,e)}).catch(t=>{console.log(t),w.value=!1,e.close()})}function V(){N.value=!0,w.value=!0;const e=y();x(e)}function y(e={}){return ie["a"].service({body:!0,lock:!0,text:o("reading-notes"),...e})}function E(){const e=y();ee().then(()=>{e.close()}).catch(t=>{re["a"].error(t),e.close()})}function T(e=!1){e&&(f.value="2"),C(),a("parse",p)}function _(){a("submit",p.api)}function C(){const{noTag:e,api:t,tag:o,split:n,tagPosition:c,noEmptyLine:a}=p,l={noTag:e,api:t,tag:o,split:n,tagPosition:c,noEmptyLine:a};localStorage.setItem("options",JSON.stringify(l))}const L=Object(n["ref"])("");function A(){let e="";const{tag:t,book:o,noTag:n}=p;if(n)return a("update-tag",e),void(L.value=e);e=t?`#${t}/${o}`:"#"+o,a("update-tag",e),L.value=e}function D(e){if(e){const t=y();le(e).then(()=>{t.close()})}}function I(){document.querySelector("#fileSelect input").addEventListener("change",e=>{const t=y(),o=e.target.files[0],n=o.name.split(".").pop().toLowerCase(),c=new FileReader;c.onload=async()=>{try{"txt"===n&&await $(c.result),"html"===n&&await H(c.result),"json"===n&&await Z(c.result),t.close()}catch(e){console.log("txt 解析出错："+e),t.close()}},c.readAsText(o)})}return Object(n["onMounted"])(()=>{I()}),(e,t)=>{const c=Object(n["resolveComponent"])("el-upload"),a=Object(n["resolveComponent"])("el-tooltip"),i=Object(n["resolveComponent"])("el-form-item"),r=Object(n["resolveComponent"])("el-input"),m=Object(n["resolveComponent"])("el-divider"),j=Object(n["resolveComponent"])("el-checkbox"),g=Object(n["resolveComponent"])("el-radio-button"),v=Object(n["resolveComponent"])("el-radio-group"),k=Object(n["resolveComponent"])("el-collapse-item"),y=Object(n["resolveComponent"])("el-radio"),T=Object(n["resolveComponent"])("el-collapse"),C=Object(n["resolveComponent"])("el-form"),L=Object(n["resolveComponent"])("el-button"),A=Object(n["resolveComponent"])("el-dialog"),B=Object(n["resolveDirective"])("loading");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:Object(n["normalizeClass"])(["left-bar",{"pt-10":!Object(n["unref"])(b),electron:Object(n["unref"])(b)}])},[Object(n["createElementVNode"])("div",ke,[Object(n["createVNode"])(C,{model:Object(n["unref"])(p),ref:"form",size:"mini","label-suffix":"：","label-position":"top"},{default:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",Ne,[Object(n["createElementVNode"])("div",we,[Object(n["createVNode"])(i,{"label-width":"0"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(c,{id:"fileSelect",style:{width:"100%"},"show-file-list":!1,multiple:!1,action:"","auto-upload":!1,accept:".html,.txt,.json"},{default:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",xe,[Ve,Object(n["createElementVNode"])("div",ye,Object(n["toDisplayString"])(Object(n["unref"])(o)("upload-file")),1)])]),_:1}),Object(n["createElementVNode"])("div",Ee,[Te,Object(n["createVNode"])(a,{effect:"dark",placement:"right"},{content:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",null,[_e,Ce,Se,Le,Ae,Object(n["createElementVNode"])("div",{class:"link pointer underline bold text-highlight",onClick:t[0]||(t[0]=e=>Object(n["unref"])(S)("https://mp.weixin.qq.com/s/CPIYoGItJVWJGk30MoVNXA"))},Object(n["toDisplayString"])(Object(n["unref"])(o)("how-export")),1)])]),default:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("span",De,Object(n["toDisplayString"])(Object(n["unref"])(o)("questions-and-answers")),1)]),_:1})])]),_:1}),Object(n["createVNode"])(i,{"label-width":"0"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(r,{id:"wx-clipboard",style:{width:"100%"},rows:3,type:"textarea",placeholder:"微信读书中复制笔记到粘贴板，粘贴到上面的输入框",onInput:D,modelValue:l.value,"onUpdate:modelValue":t[1]||(t[1]=e=>l.value=e)},null,8,["modelValue"]),Object(n["createElementVNode"])("div",Be,[Ie,Object(n["createVNode"])(a,{effect:"dark",placement:"right"},{content:Object(n["withCtx"])(()=>[Ue]),default:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("span",Pe,Object(n["toDisplayString"])(Object(n["unref"])(o)("questions-and-answers")),1)]),_:1})])]),_:1}),Object(n["unref"])(b)?(Object(n["openBlock"])(),Object(n["createBlock"])(i,{key:0,"label-width":"0"},{default:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",Re,[Object(n["createElementVNode"])("div",{class:"pointer text-center border pd-10 radius flex-item",onClick:E}," Apple Books "),Object(n["createElementVNode"])("div",{class:"pointer text-center border pd-10 radius flex-item",onClick:V},Object(n["toDisplayString"])(Object(n["unref"])(o)("weread")),1)])]),_:1})):(Object(n["openBlock"])(),Object(n["createBlock"])(i,{key:1,"label-width":"0"},{default:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",Me,[Object(n["createVNode"])(a,{effect:"dark",placement:"right"},{content:Object(n["withCtx"])(()=>[qe]),default:Object(n["withCtx"])(()=>[Fe]),_:1})]),$e]),_:1}))]),Object(n["createElementVNode"])("div",ze,[Object(n["createVNode"])(T,{modelValue:Object(n["unref"])(f),"onUpdate:modelValue":t[11]||(t[11]=e=>Object(n["isRef"])(f)?f.value=e:f=e),accordion:""},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(k,{name:"1"},{title:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",null,[Je,Object(n["createTextVNode"])(Object(n["toDisplayString"])(Object(n["unref"])(o)("parse-options")),1)])]),default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(m,null,{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(Object(n["unref"])(o)("api-options")),1)]),_:1}),Object(n["createVNode"])(i,{label:"","label-width":"0px"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(r,{modelValue:Object(n["unref"])(p).api,"onUpdate:modelValue":t[2]||(t[2]=e=>Object(n["unref"])(p).api=e),type:"password","show-password":"",placeholder:"API 采用本地存储"},null,8,["modelValue"])]),_:1}),Object(n["createVNode"])(m,null,{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(Object(n["unref"])(o)("tag-options")),1)]),_:1}),Object(n["createVNode"])(i,{label:"Tag"},{default:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",He,[Object(n["createElementVNode"])("div",Ke,[Object(n["createVNode"])(r,{modelValue:Object(n["unref"])(p).tag,"onUpdate:modelValue":t[3]||(t[3]=e=>Object(n["unref"])(p).tag=e),disabled:Object(n["unref"])(p).noTag,placeholder:"Tag 名称",clearable:""},null,8,["modelValue","disabled"])]),Object(n["createElementVNode"])("div",Ze,[Object(n["createVNode"])(j,{modelValue:Object(n["unref"])(p).noTag,"onUpdate:modelValue":t[4]||(t[4]=e=>Object(n["unref"])(p).noTag=e)},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(Object(n["unref"])(o)("hide-tag")),1)]),_:1},8,["modelValue"])])])]),_:1}),Object(n["unref"])(p).noTag?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],{key:0},[Object(n["createVNode"])(i,{label:Object(n["unref"])(o)("position-of-tag")},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(v,{modelValue:Object(n["unref"])(p).tagPosition,"onUpdate:modelValue":t[5]||(t[5]=e=>Object(n["unref"])(p).tagPosition=e)},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(g,{label:!0},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(Object(n["unref"])(o)("top")),1)]),_:1}),Object(n["createVNode"])(g,{label:!1},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(Object(n["unref"])(o)("bottom")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),Object(n["createVNode"])(i,{label:"空行"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(v,{modelValue:Object(n["unref"])(p).noEmptyLine,"onUpdate:modelValue":t[6]||(t[6]=e=>Object(n["unref"])(p).noEmptyLine=e)},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(g,{label:!1},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(Object(n["unref"])(o)("on")),1)]),_:1}),Object(n["createVNode"])(g,{label:!0},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(Object(n["unref"])(o)("off")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})],64)),Object(n["createVNode"])(m,null,{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(Object(n["unref"])(o)("notes-options")),1)]),_:1}),Object(n["createVNode"])(i,{label:"位置"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(v,{modelValue:Object(n["unref"])(p).notePosition,"onUpdate:modelValue":t[7]||(t[7]=e=>Object(n["unref"])(p).notePosition=e)},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(g,{label:!0},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("摘录上方")]),_:1}),Object(n["createVNode"])(g,{label:!1},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("摘录下方")]),_:1})]),_:1},8,["modelValue"])]),_:1}),Object(n["createVNode"])(i,{label:"分隔符"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(r,{modelValue:Object(n["unref"])(p).split,"onUpdate:modelValue":t[8]||(t[8]=e=>Object(n["unref"])(p).split=e),placeholder:"为空以空行填充，此空行无法禁用",clearable:""},null,8,["modelValue"]),Xe]),_:1})]),_:1}),Object(n["createVNode"])(k,{name:"2"},{title:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",null,[We,Object(n["createTextVNode"])(Object(n["toDisplayString"])(Object(n["unref"])(o)("book-list")),1)])]),default:Object(n["withCtx"])(()=>[d.value.length?(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],{key:0},[Object(n["createVNode"])(i,{label:Object(n["unref"])(o)("book-name")},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(r,{modelValue:Object(n["unref"])(p).book,"onUpdate:modelValue":t[9]||(t[9]=e=>Object(n["unref"])(p).book=e),onBlur:u},null,8,["modelValue"])]),_:1},8,["label"]),Object(n["createVNode"])(i,{label:Object(n["unref"])(o)("book-list"),"label-width":"0"},{default:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",Ge,[Object(n["createVNode"])(v,{class:"book-list",modelValue:Object(n["unref"])(p).title,"onUpdate:modelValue":t[10]||(t[10]=e=>Object(n["unref"])(p).title=e),size:"small",onChange:h},{default:Object(n["withCtx"])(()=>[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(d.value,e=>(Object(n["openBlock"])(),Object(n["createBlock"])(y,{key:e.uuid,label:e.title,border:""},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.title),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])])]),_:1},8,["label"])],64)):Object(n["createCommentVNode"])("",!0)]),_:1})]),_:1},8,["modelValue"])])])]),_:1},8,["model"])]),Object(n["createElementVNode"])("div",Ye,[O.value?(Object(n["openBlock"])(),Object(n["createBlock"])(a,{key:0,effect:"dark",disabled:!1,content:s.value?"导入数量已达 100 条限额":"请确保 API 已填写，需要导入的 MEMO 已勾选",placement:"top"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(L,{type:"primary",disabled:O.value,size:"mini"},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(Object(n["unref"])(o)("import")),1)]),_:1},8,["disabled"])]),_:1},8,["content"])):(Object(n["openBlock"])(),Object(n["createBlock"])(L,{key:1,type:"primary",size:"mini",onClick:_},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(Object(n["unref"])(o)("import")),1)]),_:1}))]),Object(n["createVNode"])(A,{"custom-class":"login-dialog",modelValue:N.value,"onUpdate:modelValue":t[13]||(t[13]=e=>N.value=e),"close-on-click-modal":!1,"append-to-body":"","destroy-on-close":"",width:"270px"},{default:Object(n["withCtx"])(()=>[Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Qe,[N.value?(Object(n["openBlock"])(),Object(n["createElementBlock"])("iframe",et)):Object(n["createCommentVNode"])("",!0)])),[[B,w.value]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",tt,[Object(n["createVNode"])(L,{type:"text",style:{color:"#999999"},onClick:t[12]||(t[12]=e=>N.value=!1)},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("取消")]),_:1}),Object(n["createVNode"])(L,{type:"text",onClick:x},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("我已登录")]),_:1})],512),[[n["vShow"],!w.value]])]),_:1},8,["modelValue"])],2)}}});o("0645");const nt=r()(ot,[["__scopeId","data-v-67e19656"]]);var ct=nt,at=(o("e681"),o("f923"),o("bd68"),o("388f"),o("a596")),lt=o.n(at);const it=e=>(Object(n["pushScopeId"])("data-v-626e444e"),e=e(),Object(n["popScopeId"])(),e),rt={class:"right-content-bar"},st={class:"flex-1 flex"},dt=it(()=>Object(n["createElementVNode"])("div",{style:{width:"200px","line-height":"1.5em"}}," 未经审视的生活不值得过，未经审视的思想也不应该汇入你的大脑。建议在导入前审视一遍内容。 ",-1)),ut={class:"highlight"},bt={class:"highlight"},pt={class:"highlight"},ft={class:"bar-right"},Ot=it(()=>Object(n["createElementVNode"])("div",{class:"export k-icon"},null,-1)),mt=it(()=>Object(n["createElementVNode"])("div",{class:"help-box"},[Object(n["createElementVNode"])("div",{class:"mb-10"},"注意事项："),Object(n["createElementVNode"])("div",{class:"mb-6"},"1. 导入前必须填写 Api 与选择要导入的笔记"),Object(n["createElementVNode"])("div",{class:"mb-6"},"2. 双击笔记可进入编辑状态，编辑过的笔记右下角显示编辑图标"),Object(n["createElementVNode"])("div",{class:"mb-6"},"3. 已导入的笔记右下角显示 flomo 图标，且不可再编辑"),Object(n["createElementVNode"])("div",{class:"mb-6"},"4. 点击右下角图标可还原内容，重置笔记状态"),Object(n["createElementVNode"])("div",{class:"mb-6"},"5. 已导入或编辑过的笔记将不再参与格式调整，如需调整请先重置笔记状态"),Object(n["createElementVNode"])("div",{class:"mb-10"},"还有其他问题？扫码进群反馈"),Object(n["createElementVNode"])("img",{class:"block block-center",width:"200",height:"200",src:lt.a})],-1)),jt=["title"],ht=it(()=>Object(n["createElementVNode"])("div",{class:"setting k-icon"},null,-1)),gt={href:"https://evolly.one",target:"_blank"},vt=it(()=>Object(n["createElementVNode"])("a",{href:"https://album.animalcrossing.life",target:"_blank"},"Tit1e's Photo Studio",-1)),kt={href:"https://web.okjike.com/u/FFDB1E46-63DC-43BE-AA1A-36F3D9CD0017",target:"_blank"},Nt={href:"https://mp.weixin.qq.com/s/o793lUsBaWc61fLZzFDlxg",target:"_blank",rel:"noopener noreferrer"};var wt=Object(n["defineComponent"])({__name:"index",emits:["export"],setup(e,{emit:t}){const a=Object(k["b"])(),l=a.getters.isElectron;let i={};l&&(i=o("caea").ipcRenderer);const r=t,s=Object(n["ref"])(!1);function d(){s.value=!s.value,a.commit("SELECT_ALL",s.value)}function u(e){r("export",e)}const{t:b,locale:p}=Object(c["b"])();function f(){p.value="zh-CN"===p.value?"en-US":"zh-CN",window.localStorage.setItem("locale",p.value)}a.commit("GET_IMPORT_COUNT");const O=Object(n["computed"])(()=>a.getters.selectedList.length),m=Object(n["computed"])(()=>a.getters.textList.length),j=Object(n["computed"])(()=>a.getters.importCount),h={blog:"https://evolly.one/",photo:"https://album.animalcrossing.life/",jike:"https://web.okjike.com/u/FFDB1E46-63DC-43BE-AA1A-36F3D9CD0017",thank:"https://mp.weixin.qq.com/s/o793lUsBaWc61fLZzFDlxg"};function g(e){l&&("update"===e?i.send("update"):S(h[e]))}let v=null;return l&&(i.on("updateDownloading",async(e,t)=>{if("updateDownloaded"===t)v&&v.close(),await Object(n["nextTick"])(),v=null;else{v||(v=ie["a"].service({text:"正在下载... 0%",lock:!0,spinner:"el-icon-loading",background:"rgba(255, 255, 255, 1)"}));const e=t.percent.toFixed(2);v&&v.setText(`正在下载... ${e}%`)}}),i.on("updateDownloaded",()=>{}),i.on("updateNotAvailable",(e,t)=>{console.log("updateNotAvailable",t)})),(e,t)=>{const o=Object(n["resolveComponent"])("el-button"),c=Object(n["resolveComponent"])("el-tooltip"),a=Object(n["resolveComponent"])("el-dropdown-item"),i=Object(n["resolveComponent"])("el-dropdown-menu"),r=Object(n["resolveComponent"])("el-dropdown");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",rt,[Object(n["createElementVNode"])("div",st,[Object(n["createVNode"])(c,{effect:"dark",placement:"left"},{content:Object(n["withCtx"])(()=>[dt]),default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(o,{type:"text",class:"mr-10",onClick:d},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(Object(n["unref"])(b)(s.value?"not-all":"all")),1)]),_:1})]),_:1}),Object(n["createTextVNode"])(" 已选择 "),Object(n["createElementVNode"])("span",ut,Object(n["toDisplayString"])(O.value),1),Object(n["createTextVNode"])(" 条，共 "),Object(n["createElementVNode"])("span",bt,Object(n["toDisplayString"])(m.value),1),Object(n["createTextVNode"])(" 条。已导入 "),Object(n["createElementVNode"])("span",pt,Object(n["toDisplayString"])(j.value)+" / 100",1)]),Object(n["createElementVNode"])("div",ft,[Object(n["createVNode"])(r,{onCommand:u},{dropdown:Object(n["withCtx"])(()=>[Object(n["createVNode"])(i,null,{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(a,{command:"markdown"},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("导出 Markdown")]),_:1}),Object(n["createVNode"])(a,{command:"csv"},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("导出 CSV")]),_:1}),Object(n["createVNode"])(a,{command:"alldata"},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("导出 所有数据")]),_:1})]),_:1})]),default:Object(n["withCtx"])(()=>[Ot]),_:1}),Object(n["createVNode"])(c,{effect:"dark",placement:"bottom"},{content:Object(n["withCtx"])(()=>[mt]),default:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",{class:"help k-icon",title:Object(n["unref"])(b)("help"),onClick:t[0]||(t[0]=()=>{})},null,8,jt)]),_:1}),Object(n["createVNode"])(c,{effect:"dark",placement:"bottom",content:"中/英文切换"},{default:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",{class:"translate k-icon",onClick:f})]),_:1}),Object(n["createVNode"])(r,{onCommand:g},{dropdown:Object(n["withCtx"])(()=>[Object(n["createVNode"])(i,null,{default:Object(n["withCtx"])(()=>[Object(n["unref"])(l)?(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],{key:0},[Object(n["createVNode"])(a,{command:"update"},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(Object(n["unref"])(b)("check-update")),1)]),_:1}),Object(n["createVNode"])(a,{command:"blog",divided:""},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(Object(n["unref"])(b)("blog")),1)]),_:1}),Object(n["createVNode"])(a,{command:"photo"},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(" Tit1e's Photo Studio ")]),_:1}),Object(n["createVNode"])(a,{command:"jike"},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(Object(n["unref"])(b)("jike")),1)]),_:1}),Object(n["createVNode"])(a,{command:"thank",divided:""},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(Object(n["unref"])(b)("thanks")),1)]),_:1})],64)):(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],{key:1},[Object(n["createVNode"])(a,null,{default:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("a",gt,Object(n["toDisplayString"])(Object(n["unref"])(b)("blog")),1)]),_:1}),Object(n["createVNode"])(a,null,{default:Object(n["withCtx"])(()=>[vt]),_:1}),Object(n["createVNode"])(a,null,{default:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("a",kt,Object(n["toDisplayString"])(Object(n["unref"])(b)("jike")),1)]),_:1}),Object(n["createVNode"])(a,{divided:""},{default:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("a",Nt,Object(n["toDisplayString"])(Object(n["unref"])(b)("thanks")),1)]),_:1})],64))]),_:1})]),default:Object(n["withCtx"])(()=>[ht]),_:1})])])}}});o("d451");const xt=r()(wt,[["__scopeId","data-v-626e444e"]]);var Vt=xt,yt=o("777d");const Et=["href"],Tt=["data-index"],_t={class:"priview"},Ct=["innerHTML"];var St=Object(n["defineComponent"])({__name:"index",props:{info:{type:Object,default:()=>({})},index:{type:Number,default:0}},emits:["click","reset"],setup(e,{emit:t}){const o=e,c=Object(n["computed"])(()=>o.info.uploaded),a=Object(n["computed"])(()=>!o.info.uploaded&&o.info.content_update),l=t;function i(e,t){e.stopPropagation(),(t.content_update||t.uploaded)&&yt["a"].confirm("该 memo 的内容与状态都将被还原，是否继续？","还 原",{closeOnClickModal:!1,confirmButtonText:"还 原",cancelButtonText:"取 消",type:"warning"}).then(()=>{l("reset",t)}).catch(()=>{})}let r=null,s=!1;function d(){r&&(s=!0,clearTimeout(r)),r=setTimeout(()=>{s||l("click"),clearTimeout(r),s=!1,r=null},200)}return(t,l)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:Object(n["normalizeClass"])(["memo-card radius memo-icon",{active:o.info.checked,empty:o.info.isEmpty,uploaded:c.value,edit:a.value,"num-cover":c.value||a.value}]),onClick:d},[e.info.assetid&&e.info.localtion?(Object(n["openBlock"])(),Object(n["createElementBlock"])("a",{key:0,href:`ibooks://assetid/${e.info.assetid}#${e.info.localtion}`,class:"book-mark",onClick:l[0]||(l[0]=Object(n["withModifiers"])(()=>{},["stop"])),title:"在 Apple Books 中查看"},null,8,Et)):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",{class:"num-icon","data-index":e.index+1,onClick:l[1]||(l[1]=e=>i(e,o.info))},Object(n["toDisplayString"])(c.value||a.value?"":e.index+1),9,Tt),Object(n["createElementVNode"])("div",_t,[Object(n["createElementVNode"])("pre",{innerHTML:e.info.content_update||e.info.content},null,8,Ct)])],2))}});o("c8a0");const Lt=r()(St,[["__scopeId","data-v-01e2a9cd"]]);var At=Lt,Dt={setDataConver:function(e){var t=this.browser();if(!(t["ie"]<9)){var o,n=e["data"],c="undefined"===typeof e["showLabel"]||e["showLabel"],a=(e["fileName"]||"UserExport")+".csv",l=e["columns"]||{title:[],key:[],formatter:void 0},i=(c="undefined"===typeof c||c,""),r="";if(c){if(l.title.length)l.title.map((function(e){i+=e+","}));else for(o in n[0])i+=o+",";i=i.slice(0,-1),r+=i+"\r\n"}n.map((function(e){if(i="",l.key.length)l.key.map((function(t){i+='"'+("function"===typeof l.formatter&&l.formatter(t,e[t])||e[t])+'",'}));else for(o in e)i+='"'+("function"===typeof l.formatter&&l.formatter(o,e[o])||e[o])+'",';i.slice(0,i.length-1),r+=i+"\r\n"})),r&&this.SaveAs(a,r)}},SaveAs:function(e,t){var o=this.browser();if(o["edge"]&&o["ie"])if(o["ie"]>=10||"edge"==o["edge"]){var n="\ufeff",c=new Blob([n+t],{type:"text/csv"});navigator.msSaveBlob(c,e)}else{var a=window.top.open("about:blank","_blank");a.document.write("sep=,\r\n"+t),a.document.close(),a.document.execCommand("SaveAs",!0,e),a.close()}else{var l=document.createElement("a");l.id="linkDwnldLink",l.href=this.getDownloadUrl(t),document.body.appendChild(l);var i=document.getElementById("linkDwnldLink");i.setAttribute("download",e),i.click(),document.body.removeChild(i)}},getDownloadUrl:function(e){var t="\ufeff";if(window.Blob&&window.URL&&window.URL.createObjectURL){e=new Blob([t+e],{type:"text/csv"});return URL.createObjectURL(e)}},browser:function(){var e,t={},o=navigator.userAgent.toLowerCase();return(e=-1!==o.indexOf("edge")?t.edge="edge":o.match(/rv:([\d.]+)\) like gecko/))||(e=o.match(/msie ([\d.]+)/))?t.ie=e[1]:(e=o.match(/firefox\/([\d.]+)/))?t.firefox=e[1]:(e=o.match(/chrome\/([\d.]+)/))?t.chrome=e[1]:(e=o.match(/opera.([\d.]+)/))?t.opera=e[1]:(e=o.match(/version\/([\d.]+).*safari/))&&(t.safari=e[1]),t}};async function Bt(){let e=await j("books");e=(e||[]).map(e=>(delete e.id,e.form&&(e.form=e.form,delete e.form),e)),console.log(e);let t=await j("notes");t=(t||[]).map(e=>(delete e.id,e.form&&(e.form=e.form,delete e.form),e));const o=JSON.stringify({from:"send2Flomo",books:e,notes:t}),n=new Blob([o],{type:"text/json"}),c=URL.createObjectURL(n),a=document.createElement("a");a.href=c,a.download="send2Flomo-export.json",a.click(),URL.revokeObjectURL(c)}const It={class:"content-box"},Ut={key:0,class:"no-data"},Pt={class:"memo-box"};var Rt=Object(n["defineComponent"])({__name:"index",emits:["export"],setup(e,{emit:t}){const{t:o}=Object(c["b"])(),a=Object(k["b"])(),l=a.getters.isElectron;function i(e){switch(e){case"markdown":if(!u.value.length)return!1;f();break;case"csv":if(!u.value.length)return!1;p();break;case"alldata":Bt();break}}function r(e){e.uploaded||(e.checked=!e.checked,a.commit("UPDATE_TEXT_LIST",{uuid:e.uuid,checked:e.checked}))}async function s(){const{content_temp:e,uuid:t,content:o}=m.value;e!==o&&(m.value.content=e,m.value.content_update=e,a.commit("UPDATE_TEXT_LIST",{uuid:t,content_update:e}),await v(A(m.value))),h()}async function d(e){e.uploaded=!1,e.content_update="",a.commit("UPDATE_TEXT_LIST",{uuid:e.uuid,content_update:"",uploaded:!1}),await v(A(e))}const u=Object(n["computed"])(()=>a.getters.textList),b=Object(n["computed"])(()=>a.getters.parseOptions);function p(){const{options:e,tag:t}=b.value,{title:o}=e,n=u.value.map(e=>({title:o,text:e.text.replace(/\r/g,"").replace(/\n/g,""),content_update:e.content_update.replace(/\r/g,"").replace(/\n/g,""),note:e.note||"",tag:t||"",form:e.form||""}));Dt.setDataConver({data:n,fileName:o,columns:{title:["书名","书摘","笔记","标签","修改内容"],key:["title","text","note","tag","content_update"]}})}function f(){const{options:e,tag:t}=b.value,{title:o}=e,n=u.value.reduce((e,o)=>{const n=o.update_content||o.content;return e+`- ${n.replace(o.note,"").replace(t,"").replace(/\r/g,"").replace(/\n/g,"")}\n\n`},`# ${o}\n\n`),c=new Blob([n],{type:"text/markdown"}),a=URL.createObjectURL(c),l=document.createElement("a");l.href=a,l.download=o+".md",l.click(),URL.revokeObjectURL(a)}const O=Object(n["ref"])(!1),m=Object(n["ref"])({});function j(e){e.uploaded||(m.value=e,O.value=!0)}function h(){m.value={},O.value=!1}return(e,t)=>{const c=Object(n["resolveComponent"])("el-input"),a=Object(n["resolveComponent"])("el-button"),b=Object(n["resolveComponent"])("el-dialog");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:Object(n["normalizeClass"])(["right-content",{electron:Object(n["unref"])(l)}])},[Object(n["createVNode"])(Object(n["unref"])(Vt),{class:Object(n["normalizeClass"])({"right-content-position":Object(n["unref"])(l)}),onExport:i},null,8,["class"]),Object(n["createElementVNode"])("div",It,[u.value.length?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Ut)),Object(n["createElementVNode"])("div",Pt,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(u.value,(e,t)=>(Object(n["openBlock"])(),Object(n["createBlock"])(Object(n["unref"])(At),{onDblclick:t=>j(e),onClick:t=>r(e),onReset:t=>d(e),key:e.uuid,class:"memo-item",info:e,index:t},null,8,["onDblclick","onClick","onReset","info","index"]))),128))])]),Object(n["createVNode"])(b,{modelValue:O.value,"onUpdate:modelValue":t[1]||(t[1]=e=>O.value=e),center:"",width:"600px","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},{footer:Object(n["withCtx"])(()=>[Object(n["createVNode"])(a,{onClick:h,size:"mini",type:"default"},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(Object(n["unref"])(o)("cancel")),1)]),_:1}),Object(n["createVNode"])(a,{onClick:s,size:"mini",type:"primary"},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(Object(n["unref"])(o)("save")),1)]),_:1})]),default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(c,{modelValue:m.value.content_temp,"onUpdate:modelValue":t[0]||(t[0]=e=>m.value.content_temp=e),type:"textarea",autosize:{minRows:16,maxRows:36},placeholder:"",clearable:""},null,8,["modelValue"])]),_:1},8,["modelValue"])],2)}}});o("16b5");const Mt=r()(Rt,[["__scopeId","data-v-68647881"]]);var qt=Mt;function Ft(e,t){const o={content:t};return de.a.post(e,o)}const $t={class:"content-wrap"};var zt=Object(n["defineComponent"])({__name:"App",setup(e){const t=Object(k["b"])(),o=JSON.parse(localStorage.getItem("bookSort")||"[]").reverse();B(o);const c=t.getters.isElectron,a=Object(n["computed"])(()=>t.getters.importCount),l=Object(n["computed"])(()=>t.getters.selectedList),i=Object(n["ref"])("");let r=Object(n["ref"])(0);const s=Object(n["ref"])(0),u=Object(n["computed"])(()=>`为减轻服务器压力，导入间隔为 1s。导入进度： ${r.value+1}/${s.value}`),b=Object(n["ref"])(null);function p(e=""){s.value=l.value.length,b.value=ie["a"].service({lock:!0,text:u}),r.value=0,f(e,l.value,r.value)}async function f(e,o,n){b.value.setText(u);try{const c=o[n],{code:l,message:i}=await Ft(e,c.content_update||c.content);0===l?(c.uploaded=!0,c.checked=!1,c.content_update=c.content,t.commit("SET_IMPORT_COUNT",a.value+1),t.commit("UPDATE_TEXT_LIST",{uuid:c.uuid,uploaded:!0,checked:!1,content_update:c.content}),await v(A(c)),n<o.length-1?setTimeout(()=>{r.value+=1,f(e,o,r.value)},1e3):(b.value.close(),re["a"].success(i))):re["a"].error(i)}catch(c){re["a"].error("导入失败"),b.value.close()}}function O(e){t.commit("UPDATE_PARSE_OPTIONS",{options:e,tag:i.value})}function m({list:e,options:o}){t.commit("UPDATE_PARSE_OPTIONS",{options:o,tag:i.value})}function j(e){i.value=e}return(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],null,[Object(n["unref"])(c)?(Object(n["openBlock"])(),Object(n["createBlock"])(Object(n["unref"])(d),{key:0,class:"the-head"})):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",$t,[Object(n["createVNode"])(Object(n["unref"])(ct),{class:"left-bar",ref:"leftContent",onSubmit:p,onParse:O,onListUpdate:m,onUpdateTag:j},null,512),Object(n["createVNode"])(Object(n["unref"])(qt),{class:"right-content"})])],64))}});o("c19a");const Jt=zt;var Ht=Jt,Kt=o("8278");o("f930");const Zt=o("5893"),Xt={};function Wt(){let e={};return Gt(Xt,e),e}function Gt(e,t){for(let o in e)if(e[o].default){let n=o.substr(o.lastIndexOf("/")+1,5);t[n]?t[n]={...e[n],...e[o].default}:t[n]=e[o].default}}Zt.keys().forEach(e=>{Xt[e]=Zt(e)});const Yt=window.localStorage.getItem("locale")||"zh-CN",Qt=Object(c["a"])({legacy:!1,locale:Yt,messages:Wt()});var eo=Qt;o("9536");const to=Object(n["createApp"])(Ht);to.use(Kt["a"],{size:"small",zIndex:3e3}),to.use(eo),to.use(E),to.mount("#app");t["default"]=to},d0b2:function(e,t,o){},d451:function(e,t,o){"use strict";o("c51b")},edf7:function(e,t){function o(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}o.keys=function(){return[]},o.resolve=o,e.exports=o,o.id="edf7"},f197:function(e,t,o){"use strict";o.r(t),t["default"]={parse:"Parse","how-export":"How to export HTML?","questions-and-answers":"Questions and Answers",weread:"WeRead","parse-options":"Parse Options","hide-tag":"Hide Tag","position-of-tag":"Position Of Tag",top:"Top",bottom:"Bottom",on:"On",off:"OFF","book-name":"Book Name","book-list":"Book List",import:"Import","api-options":"Api Options","tag-options":"Tag Options","notes-options":"Notes Options","reading-notes":"reading","upload-file":"Upload HTML/TXT/JSON",thanks:"Thanks for lupeng",all:"All","not-all":"DESELECT ALL","check-update":"Check Update",blog:"Blog",jike:"JIKE",help:"Help",save:"Save",cancel:"Cancel"}},f856:function(e,t,o){var n={"./Find-VisualStudio.cs":"8fa1","./build":"3e98","./build.js":"3e98","./clean":"e4e4","./clean.js":"e4e4","./configure":"573f","./configure.js":"573f","./create-config-gypi":"14fa","./create-config-gypi.js":"14fa","./find-node-directory":"fa76","./find-node-directory.js":"fa76","./find-python":"ffec","./find-python.js":"ffec","./find-visualstudio":"a8a8","./find-visualstudio.js":"a8a8","./install":"53c2","./install.js":"53c2","./list":"7706","./list.js":"7706","./node-gyp":"ca28","./node-gyp.js":"ca28","./process-release":"d3f0","./process-release.js":"d3f0","./rebuild":"2a68","./rebuild.js":"2a68","./remove":"fa1f","./remove.js":"fa1f","./util":"01a9","./util.js":"01a9"};function c(e){var t=a(e);return o(t)}function a(e){if(!o.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}c.keys=function(){return Object.keys(n)},c.resolve=a,e.exports=c,c.id="f856"},f930:function(e,t,o){},fcad:function(e,t){function o(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}o.keys=function(){return[]},o.resolve=o,e.exports=o,o.id="fcad"}});